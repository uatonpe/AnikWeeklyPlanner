<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TA System | Live Enterprise Portal</title>

    <!-- External Frameworks -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@lucide/icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.js"></script>

    <style>
        :root {
            --primary: #059669;
            --primary-light: #ecfdf5;
            --accent: #10b981;
            --slate-custom: #0f172a;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: #f1f5f9;
            background-image: radial-gradient(#cbd5e1 1px, transparent 1px);
            background-size: 30px 30px;
            color: #1e293b;
        }

        /* Glassmorphism Classes */
        .glass-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.05);
        }

        .input-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .input-card:focus-within {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(16, 185, 129, 0.2);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Animations */
        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }

        .loading-shimmer {
            background: linear-gradient(90deg, #f1f5f9 25%, #e2e8f0 50%, #f1f5f9 75%);
            background-size: 1000px 100%;
            animation: shimmer 2s infinite linear;
        }

        /* Target States */
        .status-pill {
            padding: 4px 12px;
            border-radius: 9999px;
            font-size: 11px;
            font-weight: 800;
            text-transform: uppercase;
        }

        .status-pending { background: #fef3c7; color: #92400e; }
        .status-success { background: #dcfce7; color: #166534; }
    </style>
</head>

<body class="min-h-screen pb-20">

    <!-- Header Navigation -->
    <header class="sticky top-0 z-40 w-full bg-white/80 backdrop-blur-md border-b border-slate-200">
        <div class="max-w-7xl mx-auto px-4 h-20 flex justify-between items-center">
            <div class="flex items-center gap-4">
                <div class="bg-emerald-600 p-2.5 rounded-2xl shadow-lg shadow-emerald-200">
                    <img src="https://anikfin.com/wp-content/uploads/2024/06/anik-horizontal-1-1024x400.png" class="h-6 brightness-0 invert" alt="Anik Logo">
                </div>
                <div class="hidden md:block">
                    <h1 class="text-xl font-extrabold text-slate-800 tracking-tight leading-none uppercase">TA System</h1>
                    <span class="text-[10px] font-bold text-emerald-600 tracking-[0.2em] uppercase">Enterprise Live Entry</span>
                </div>
            </div>

            <div class="flex items-center gap-6">
                <div class="hidden lg:flex flex-col text-right">
                    <span id="liveClock" class="text-sm font-black text-slate-700">00:00:00 PM</span>
                    <span class="text-[10px] font-bold text-slate-400 uppercase tracking-widest" id="liveDate">Loading Date...</span>
                </div>
                <div class="h-10 w-10 rounded-full bg-slate-100 flex items-center justify-center border-2 border-white shadow-sm">
                    <i data-lucide="shield-check" class="w-5 h-5 text-emerald-600"></i>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 pt-10">
        
        <!-- Selection Hub -->
        <section class="grid grid-cols-1 lg:grid-cols-12 gap-8 mb-10">
            
            <div class="lg:col-span-8 glass-panel rounded-[32px] p-8 animate__animated animate__fadeIn">
                <div class="flex items-center gap-3 mb-8">
                    <div class="w-1.5 h-6 bg-emerald-500 rounded-full"></div>
                    <h2 class="text-lg font-black text-slate-800 uppercase tracking-tight">‡§°‡•á‡§ü‡§æ ‡§®‡§ø‡§µ‡§° ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ (Selection Zone)</h2>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Manager Selection -->
                    <div class="space-y-3">
                        <label class="text-[11px] font-black text-slate-500 uppercase tracking-widest ml-1">‡§Æ‡•Ö‡§®‡•á‡§ú‡§∞ ‡§®‡§ø‡§µ‡§°‡§æ</label>
                        <div class="relative group">
                            <select id="mgrSelect" onchange="loadManagerData()" class="w-full appearance-none bg-slate-50 border-2 border-slate-100 rounded-2xl p-5 font-bold text-slate-700 focus:border-emerald-500 focus:bg-white outline-none transition-all cursor-pointer">
                                <option value="">-- ‡§®‡§ø‡§µ‡§°‡§æ --</option>
                            </select>
                            <div class="absolute right-5 top-1/2 -translate-y-1/2 pointer-events-none text-slate-400 group-focus-within:text-emerald-500 transition-colors">
                                <i data-lucide="chevron-down" class="w-5 h-5"></i>
                            </div>
                        </div>
                    </div>

                    <!-- Plan Selection -->
                    <div class="space-y-3">
                        <label class="text-[11px] font-black text-slate-500 uppercase tracking-widest ml-1">‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§Ü‡§†‡§µ‡§°‡§æ (Weekly Plans)</label>
                        <div class="relative group">
                            <select id="planSelect" onchange="renderMainTable()" class="w-full appearance-none bg-slate-50 border-2 border-slate-100 rounded-2xl p-5 font-bold text-slate-700 focus:border-emerald-500 focus:bg-white outline-none transition-all cursor-pointer">
                                <option value="">-- ‡§Ü‡§ß‡•Ä ‡§Æ‡•Ö‡§®‡•á‡§ú‡§∞ ‡§®‡§ø‡§µ‡§°‡§æ --</option>
                            </select>
                            <div class="absolute right-5 top-1/2 -translate-y-1/2 pointer-events-none text-slate-400 group-focus-within:text-emerald-500 transition-colors">
                                <i data-lucide="calendar-range" class="w-5 h-5"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Stats Overview Card -->
            <div class="lg:col-span-4 glass-panel rounded-[32px] p-8 bg-slate-900 text-white animate__animated animate__fadeInRight">
                <h3 class="text-xs font-black text-emerald-400 uppercase tracking-[0.2em] mb-6">Summary Metrics</h3>
                <div class="space-y-6">
                    <div class="p-4 rounded-2xl bg-white/5 border border-white/10">
                        <p class="text-[10px] font-bold text-slate-400 uppercase mb-1">Target Disbursement</p>
                        <p id="statTarget" class="text-3xl font-black">‚Çπ 0.00</p>
                    </div>
                    <div class="p-4 rounded-2xl bg-emerald-500/10 border border-emerald-500/20">
                        <p class="text-[10px] font-bold text-emerald-400 uppercase mb-1">Actual Entered</p>
                        <p id="statActual" class="text-3xl font-black text-emerald-500">‚Çπ 0.00</p>
                    </div>
                </div>
                <div class="mt-6 pt-6 border-t border-white/10">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-xs font-bold text-slate-400">Sync Status</span>
                        <span class="flex items-center gap-1.5 text-[10px] font-black uppercase text-emerald-400">
                            <span class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse"></span> Server Ready
                        </span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Dynamic Data Entry Table -->
        <div id="tableWrapper" class="hidden animate__animated animate__fadeInUp">
            <div class="glass-panel rounded-[32px] overflow-hidden">
                
                <!-- Table Header Toolstrip -->
                <div class="bg-white p-6 border-b border-slate-100 flex flex-col md:flex-row justify-between items-center gap-4">
                    <div>
                        <h2 id="tableHeading" class="text-xl font-black text-slate-800 tracking-tight">--</h2>
                        <p class="text-xs font-bold text-slate-400 uppercase tracking-widest">‡§∏‡•ç‡§ü‡§æ‡§´ ‡§Ö‚Äç‡•Ö‡§ï‡•ç‡§ö‡•Å‡§Ö‡§≤ ‡§°‡•á‡§ü‡§æ ‡§è‡§Ç‡§ü‡•ç‡§∞‡•Ä</p>
                    </div>
                    <div class="flex gap-2">
                        <div class="px-4 py-2 bg-blue-50 text-blue-700 rounded-xl text-[11px] font-black uppercase">Auto-Calculate Active</div>
                    </div>
                </div>

                <!-- Main Table -->
                <div class="overflow-x-auto">
                    <table class="w-full text-left border-collapse">
                        <thead>
                            <tr class="bg-slate-50/80">
                                <th class="p-6 text-[10px] font-black text-slate-500 uppercase tracking-[0.15em]">‡§∏‡•ç‡§ü‡§æ‡§´ ‡§®‡§æ‡§µ</th>
                                <th class="p-6 text-center text-[10px] font-black text-slate-500 uppercase tracking-[0.15em]">‡§Ü‡§†‡§µ‡§°‡§æ ‡§ü‡§æ‡§∞‡•ç‡§ó‡•á‡§ü</th>
                                <th class="p-6 text-center text-[10px] font-black text-slate-500 uppercase tracking-[0.15em]">‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§Ö‚Äç‡•Ö‡§ï‡•ç‡§ö‡•Å‡§Ö‡§≤ (Input)</th>
                                <th class="p-6 text-center text-[10px] font-black text-slate-500 uppercase tracking-[0.15em]">‡§™‡•ç‡§∞‡§ó‡§§‡•Ä (Gap)</th>
                            </tr>
                        </thead>
                        <tbody id="taBody" class="divide-y divide-slate-50">
                            <!-- JS Injection -->
                        </tbody>
                    </table>
                </div>

                <!-- Footer Action Area -->
                <div class="p-10 bg-slate-50/50 border-t border-slate-100">
                    <div class="flex flex-col md:flex-row justify-between items-center gap-8">
                        <div class="max-w-md">
                            <h4 class="font-black text-slate-700 uppercase text-sm mb-1">‡§∏‡§ø‡§Ç‡§ï ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡•Ä ‡§§‡§™‡§æ‡§∏‡§æ!</h4>
                            <p class="text-xs font-medium text-slate-400">‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§∞‡•ç‡§µ ‡§∏‡•ç‡§ü‡§æ‡§´‡§ö‡§æ ‡§Ö‚Äç‡•Ö‡§ï‡•ç‡§ö‡•Å‡§Ö‡§≤ ‡§°‡•á‡§ü‡§æ ‡§≠‡§∞‡§≤‡§æ ‡§Ü‡§π‡•á ‡§Ø‡§æ‡§ö‡•Ä ‡§ñ‡§æ‡§§‡•ç‡§∞‡•Ä ‡§ï‡§∞‡§æ. ‡§è‡§ï‡§¶‡§æ ‡§∏‡§ø‡§Ç‡§ï ‡§ï‡•á‡§≤‡•ç‡§Ø‡§æ‡§µ‡§∞ ‡§°‡•á‡§ü‡§æ ‡§∏‡§∞‡•ç‡§µ‡•ç‡§π‡§∞‡§µ‡§∞ ‡§Ö‡§™‡§°‡•á‡§ü ‡§π‡•ã‡§à‡§≤.</p>
                        </div>
                        <button onclick="syncToServer()" id="submitBtn" class="group w-full md:w-auto bg-emerald-600 hover:bg-emerald-700 text-white px-12 py-5 rounded-[20px] font-black uppercase tracking-widest shadow-2xl shadow-emerald-200 flex items-center justify-center gap-4 transition-all hover:scale-[1.03] active:scale-95">
                            <i data-lucide="cloud-lightning" class="w-6 h-6 animate-pulse"></i>
                            ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§°‡•á‡§ü‡§æ ‡§∏‡§ø‡§Ç‡§ï ‡§ï‡§∞‡§æ
                        </button>
                    </div>
                </div>

            </div>
        </div>

        <!-- Initial Placeholder -->
        <div id="placeholder" class="py-20 flex flex-col items-center justify-center opacity-40">
            <div class="w-24 h-24 bg-slate-200 rounded-full flex items-center justify-center mb-6">
                <i data-lucide="database-backup" class="w-10 h-10 text-slate-500"></i>
            </div>
            <p class="text-sm font-black uppercase tracking-[0.3em] text-slate-500">Wait for selection...</p>
        </div>

    </main>

    <!-- Global Loading Overlay -->
    <div id="globalLoader" class="fixed inset-0 bg-slate-900/60 backdrop-blur-md z-[100] hidden flex-col items-center justify-center">
        <div class="relative w-20 h-20">
            <div class="absolute inset-0 border-4 border-emerald-500/20 rounded-full"></div>
            <div class="absolute inset-0 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin"></div>
        </div>
        <p class="mt-6 text-white font-black tracking-[0.2em] uppercase animate-pulse">Processing Data...</p>
    </div>

    <!-- Script Logic -->
    <script>
        // --- CONFIGURATION ---
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxrsdH0yjhKLl6mQi7pnq6l__J3M3BZvmqseBxYDamv18zi6o8BfRcPcYIK06Boy6Ma/exec"; 
        let currentHistory = [];
        let activeIdx = null;

        // --- INITIALIZATION ---
        async function init() {
            lucide.createIcons();
            updateClock();
            setInterval(updateClock, 1000);
            
            toggleLoader(true);
            try {
                const resp = await fetch(`${SCRIPT_URL}?action=getManagers`);
                const managers = await resp.json();
                const sel = document.getElementById('mgrSelect');
                
                managers.forEach(m => {
                    const opt = document.createElement('option');
                    opt.value = m;
                    opt.textContent = m;
                    sel.appendChild(opt);
                });
                
                toast("System Initialized", "success");
            } catch (err) {
                console.error("Init Error:", err);
                Swal.fire("Connection Error", "‡§∏‡§∞‡•ç‡§µ‡•ç‡§π‡§∞‡§∂‡•Ä ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§π‡•ã‡§ä ‡§∂‡§ï‡§≤‡§æ ‡§®‡§æ‡§π‡•Ä.", "error");
            } finally {
                toggleLoader(false);
            }
        }

        // --- CORE FUNCTIONS ---
        async function loadManagerData() {
            const mgr = document.getElementById('mgrSelect').value;
            if(!mgr) { resetUI(); return; }

            toggleLoader(true);
            try {
                const resp = await fetch(`${SCRIPT_URL}?action=getManagerData&manager=${encodeURIComponent(mgr)}`);
                const data = await resp.json();
                currentHistory = data.history;

                const planSel = document.getElementById('planSelect');
                planSel.innerHTML = '<option value="">-- ‡§™‡•ç‡§≤‡•Ö‡§® ‡§®‡§ø‡§µ‡§°‡§æ --</option>';
                
                currentHistory.forEach((h, i) => {
                    // Clarifying Dates for User
                    const dateDisplay = `üìÖ Week: ${h.sDate} to ${h.eDate}`;
                    const opt = document.createElement('option');
                    opt.value = i;
                    opt.textContent = dateDisplay;
                    planSel.appendChild(opt);
                });

                toast("‡§Æ‡•Ö‡§®‡•á‡§ú‡§∞ ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§ù‡§æ‡§≤‡§æ");
            } catch (err) {
                toast("Error fetching data", "error");
            } finally {
                toggleLoader(false);
            }
        }

        function renderMainTable() {
            const idx = document.getElementById('planSelect').value;
            if(idx === "") {
                document.getElementById('tableWrapper').classList.add('hidden');
                document.getElementById('placeholder').classList.remove('hidden');
                return;
            }

            activeIdx = idx;
            const plan = currentHistory[idx];
            const body = document.getElementById('taBody');
            
            // UI Updates
            document.getElementById('tableHeading').innerText = `‡§Ü‡§†‡§µ‡§°‡§æ: ${plan.sDate} - ${plan.eDate}`;
            document.getElementById('tableWrapper').classList.remove('hidden');
            document.getElementById('placeholder').classList.add('hidden');
            
            body.innerHTML = "";
            let totalT = 0;

            plan.details.forEach((item, i) => {
                totalT += parseFloat(item.tDisb || 0);
                
                const row = document.createElement('tr');
                row.className = "group hover:bg-emerald-50/50 transition-all";
                row.innerHTML = `
                    <td class="p-6">
                        <div class="flex items-center gap-4">
                            <div class="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center font-black text-slate-400 text-xs">
                                ${i + 1}
                            </div>
                            <div>
                                <p class="font-extrabold text-slate-700 tracking-tight">${item.name}</p>
                                <p class="text-[10px] font-bold text-slate-400 uppercase tracking-tighter">Field Executive</p>
                            </div>
                        </div>
                    </td>
                    <td class="p-6 text-center">
                        <div class="inline-block px-4 py-2 bg-slate-100 rounded-xl">
                            <span class="text-sm font-black text-slate-600">‚Çπ ${formatINR(item.tDisb)}</span>
                        </div>
                    </td>
                    <td class="p-6">
                        <div class="relative max-w-[180px] mx-auto group">
                            <input type="number" 
                                class="act-input w-full bg-white border-2 border-slate-200 rounded-2xl p-4 text-center font-black text-slate-700 outline-none focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 transition-all"
                                value="${item.aDisb || ''}"
                                placeholder="0.00"
                                data-index="${i}"
                                oninput="calculateRealtime()">
                        </div>
                    </td>
                    <td class="p-6 text-center">
                        <div class="gap-status text-[11px] font-black uppercase tracking-widest text-slate-300">
                            - 0.00
                        </div>
                    </td>
                `;
                body.appendChild(row);
            });

            document.getElementById('statTarget').innerText = `‚Çπ ${formatINR(totalT)}`;
            calculateRealtime();
        }

        function calculateRealtime() {
            const inputs = document.querySelectorAll('.act-input');
            let totalActual = 0;
            const plan = currentHistory[activeIdx];

            inputs.forEach((inp, idx) => {
                const val = parseFloat(inp.value) || 0;
                const target = parseFloat(plan.details[idx].tDisb) || 0;
                totalActual += val;

                // Gap Calculation
                const gapCell = inp.closest('tr').querySelector('.gap-status');
                const diff = val - target;

                if (val === 0) {
                    gapCell.innerText = "N/A";
                    gapCell.className = "gap-status text-[11px] font-black text-slate-300";
                } else if (diff >= 0) {
                    gapCell.innerText = `‚úÖ +${formatINR(diff)}`;
                    gapCell.className = "gap-status text-[11px] font-black text-emerald-600";
                } else {
                    gapCell.innerText = `üìâ -${formatINR(Math.abs(diff))}`;
                    gapCell.className = "gap-status text-[11px] font-black text-red-500";
                }
            });

            document.getElementById('statActual').innerText = `‚Çπ ${formatINR(totalActual)}`;
        }

        async function syncToServer() {
            const inputs = document.querySelectorAll('.act-input');
            const plan = currentHistory[activeIdx];
            
            // Check if all fields are filled
            let allFilled = true;
            inputs.forEach(i => { if(i.value === "") allFilled = false; });
            
            if(!allFilled) {
                const confirm = await Swal.fire({
                    title: '‡§ï‡§æ‡§π‡•Ä ‡§∞‡§ï‡§æ‡§®‡•á ‡§∞‡§ø‡§ï‡§æ‡§Æ‡•á ‡§Ü‡§π‡•á‡§§!',
                    text: "‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§≤‡§æ ‡§∂‡•Ç‡§®‡•ç‡§Ø (0) ‡§Ö‚Äç‡•Ö‡§ï‡•ç‡§ö‡•Å‡§Ö‡§≤ ‡§°‡•á‡§ü‡§æ‡§∏‡§π ‡§∏‡§ø‡§Ç‡§ï ‡§ï‡§∞‡§æ‡§Ø‡§ö‡•á ‡§Ü‡§π‡•á ‡§ï‡§æ?",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonText: '‡§π‡•ã, ‡§ö‡§æ‡§≤‡•Ç ‡§†‡•á‡§µ‡§æ',
                    cancelButtonText: '‡§§‡§™‡§æ‡§∏‡§æ'
                });
                if(!confirm.isConfirmed) return;
            }

            toggleLoader(true);
            
            const updatedDetails = plan.details.map((item, i) => ({
                ...item,
                aDisb: inputs[i].value || 0
            }));

            const payload = { 
                manager: document.getElementById('mgrSelect').value, 
                sDate: plan.sDate, 
                eDate: plan.eDate, 
                fxDetails: updatedDetails 
            };

            try {
                // Use fetch for POST
                await fetch(SCRIPT_URL, { 
                    method: 'POST', 
                    mode: 'no-cors', // Common with GAS
                    body: JSON.stringify(payload) 
                });

                Swal.fire({
                    icon: 'success',
                    title: '‡§Ø‡§∂‡§∏‡•ç‡§µ‡•Ä ‡§∏‡§ø‡§Ç‡§ï!',
                    text: '‡§§‡•Å‡§Æ‡§ö‡§æ ‡§°‡•á‡§ü‡§æ ‡§∏‡§∞‡•ç‡§µ‡•ç‡§π‡§∞‡§µ‡§∞ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§‡§™‡§£‡•á ‡§∏‡•á‡§µ‡•ç‡§π ‡§ù‡§æ‡§≤‡§æ ‡§Ü‡§π‡•á.',
                    confirmButtonColor: '#059669'
                }).then(() => location.reload());

            } catch (err) {
                console.error("Sync Error:", err);
                Swal.fire("Error", "‡§∏‡§ø‡§Ç‡§ï ‡§ï‡§∞‡§§‡§æ‡§®‡§æ ‡§Ö‡§°‡§ö‡§£ ‡§Ü‡§≤‡•Ä. ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Å‡§®‡•ç‡§π‡§æ ‡§™‡•ç‡§∞‡§Ø‡§§‡•ç‡§® ‡§ï‡§∞‡§æ.", "error");
            } finally {
                toggleLoader(false);
            }
        }

        // --- HELPERS ---
        function toggleLoader(show) {
            document.getElementById('globalLoader').classList.toggle('hidden', !show);
        }

        function formatINR(num) {
            return new Intl.NumberFormat('en-IN', { maximumFractionDigits: 0 }).format(num);
        }

        function updateClock() {
            const now = new Date();
            const dateStr = now.toLocaleDateString('mr-IN', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            const timeStr = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true });
            
            document.getElementById('liveClock').innerText = timeStr;
            document.getElementById('liveDate').innerText = dateStr;
        }

        function toast(msg, icon = "success") {
            const Toast = Swal.mixin({
                toast: true,
                position: 'top-end',
                showConfirmButton: false,
                timer: 3000,
                timerProgressBar: true
            });
            Toast.fire({ icon: icon, title: msg });
        }

        function resetUI() {
            document.getElementById('planSelect').innerHTML = '<option value="">-- ‡§Ü‡§ß‡•Ä ‡§Æ‡•Ö‡§®‡•á‡§ú‡§∞ ‡§®‡§ø‡§µ‡§°‡§æ --</option>';
            document.getElementById('tableWrapper').classList.add('hidden');
            document.getElementById('placeholder').classList.remove('hidden');
            document.getElementById('statTarget').innerText = "‚Çπ 0.00";
            document.getElementById('statActual').innerText = "‚Çπ 0.00";
        }

        window.onload = init;
    </script>
</body>
</html>
